{-
  case (ฮณ ฮ te) of
  {!!}
  continueโ where

  continueโ : InitialCtxTypingInstance ฮ te -> TypingDecision ฮ (app te se)
  continueโ ((ฮฝsโโ / ฮฝsโโ โฉ ฮโ , ฮฑแตโ , ฮ<ฮโ , ฮโโขฮฑแตโ), ฮฉโ) =
    case (ฮณ _ se) of
    {!!}
    continueโ where

    continueโ : InitialCtxTypingInstance ฮโ  se -> TypingDecision ฮ (app te se)
    continueโ ((ฮฝsโโ / ฮฝsโโ โฉ ฮโ , ฮฒแตโ , ฮโ<ฮโ , ฮโโขฮฒแตโ), ฮฉโ) = resn res where

      ฮฝs = ฮฝsโ


      ฯแตแตคโ : _ โถ ฮฝsโโ
      ฯแตแตคโ = fst ฮ<ฮโ

      -- lift the ฯ0 typing to ฮโ
      ฯแตโโ : ฮฝsโโ โถ ฮฝsโโ
      ฯแตโโ = fst ฮโ<ฮโ

      ฯแตแตคโ : ฮฝsโ โถ ฮฝsโโ
      ฯแตแตคโ = ฯแตแตคโ โ ฯแตโโ

      ฮฝsโ = ฮฝsโโ โ ฮฝsโโ

      ฯแตคโ : ฮฝs โถ ฮฝsโ
      ฯแตคโ = ฯแตแตคโ โ ฮนโ


      ฮฝsโ = ฮฝsโโ โ (ฮฝsโโ โ ฮฝsโโ)

      ฯโโ : ฮฝsโ โถ ฮฝsโ
      ฯโโ = ฯแตโโ โโโ ฮนโ


      -- we lift ฮฑโ to the metas ฮฝsโ
      -- ฯโ'
      ฮฑโ : โHMType โจ ฮฝsโโ โ (ฮฝsโโ โ ฮฝsโโ) โฉ
      ฮฑโ = ฮฑแตโ โ[ ฯโโ ]โ

      ฮฒโ : โHMType โจ ฮฝsโโ โ (ฮฝsโโ โ ฮฝsโโ) โฉ
      ฮฒโ = ฮฒแตโ โ[ id โโโ ฮนโ ]โ

      -- we need a new type variable for the return
      -- type of the application, so we move to ฮฝsโ
      ฮฝsโโ = ฮฝsโโ
      ฮฝsโ = ฮฝsโโ โ (ฮฝsโโ โ ฮฝsโโ โ st)

      ฯโโ : ฮฝsโ โถ ฮฝsโ
      ฯโโ = id โโโ ฮนโ

      -- ฯแตคโ : ฮฝs โถ ฮฝsโ
      -- ฯแตคโ = ฯแตคโ โ ฯโโ โ ฯโโ

      ฮฑโ : โHMType โจ ฮฝsโโ โ (ฮฝsโโ โ ฮฝsโโ โ st) โฉ
      ฮฑโ = ฮฑโ โ[ ฯโโ ]โ

      ฮฒโ : โHMType โจ ฮฝsโ โฉ
      ฮฒโ = ฮฒโ โ[ ฯโโ ]โ


      -- ฮโ = ฮโ โ[ ฯโโ ]โแถ
      ฮโ = ฮโ

      -- we call the new type ฮณ
      ฮณแตโ : โHMType โจ st โฉ
      ฮณแตโ = var incl

      ฮณโ : โHMType โจ ฮฝsโ โฉ
      ฮณโ = ฮณแตโ โ[ ฮนโ โ ฮนโ ]โ

      -- the types which we unify are:
      u : โHMType โจ ฮฝsโ โฉ
      u = ฮฑโ

      v : โHMType โจ ฮฝsโ โฉ
      v = ฮฒโ โ ฮณโ


      res = unify-โHMTypes (asArr u) (asArr v)

      resn : (ยฌ hasCoequalizerCandidate (asArr u , asArr v)) +-๐ฐ (hasCoequalizer (asArr u) (asArr v))
            -> (CtxTypingInstance ฮ (app te se) -> โฅ-๐ฐ {โโ}) + InitialCtxTypingInstance ฮ (app te se)
      resn (left _) = {!!}
      resn (right x) = right (๐ , {!!}) -- right (๐ , isInitial:๐)
        where
          -- we now have the coequalizer `ฯโ`,
          -- but we need to factorize the map ฮนโ โ ฯโ
          f : ฮฝsโโ โถ โจ x โฉ
          f = ฮนโ โ ฯโ

          factor:f = factorize f

          ฮฝsโโ = image factor:f
          ฮฝsโโ = rest factor:f

          ฮฝsโ = ฮฝsโโ โ ฮฝsโโ

          ฯโโ : ฮฝsโ โถ ฮฝsโ
          ฯโโ = ฯโ โ โจ splitting factor:f โฉโปยน

          ฯ = splitting factor:f

          ฯแตโโ : ฮฝsโโ โถ ฮฝsโโ
          ฯแตโโ = epiHom factor:f

          ฮฒโ = ฮฒโ โ[ ฯโโ ]โ
          ฮณโ = ฮณโ โ[ ฯโโ ]โ
          ฮโ = ฮโ โ[ ฯแตโโ ]โแถ

          lem-0 : ฮนโ โ ฯโโ โผ ฯแตโโ โ ฮนโ
          lem-0 = {!!}

          -- thus the full substitution we need is the following
          -- ฯแตคโ = ฯแตคโ โ ฯโโ โ ฯโโ โ ฯโโ

          ฮโ<ฮโ : ฮโ <ฮ ฮโ
          ฮโ<ฮโ = record { fst = ฯแตโโ ; snd = refl-โก }

          ฮ<ฮโ : ฮ <ฮ ฮโ
          ฮ<ฮโ = ฮ<ฮโ โก ฮโ<ฮโ โก ฮโ<ฮโ


          -- we know that under `ฯโโ` both ฮฑโ and `ฮฒโ โ ฮณโ` are the same
          postulate lem-5 : ฮฑโ โ[ ฯโโ ]โ โก (ฮฒโ โ ฮณโ) โ[ ฯโโ ]โ
          {-
          lem-5 = ฮฑโ โ[ ฯโ โ โจ splitting factor:f โฉโปยน ]โ      โจ sym-Path (functoriality-โ-โ[]โ {ฯ = ฮฑโ} {f = ฯโ} {โจ splitting factor:f โฉโปยน}) โฉ-โก
                  ฮฑโ โ[ ฯโ ]โ โ[ โจ splitting factor:f โฉโปยน ]โ  โจ cong _โ[ โจ splitting factor:f โฉโปยน ]โ lem-5b โฉ-โก
                  (ฮฒโ โ ฮณโ) โ[ ฯโ ]โ โ[ โจ splitting factor:f โฉโปยน ]โ โจ functoriality-โ-โ[]โ {ฯ = ฮฒโ โ ฮณโ} {f = ฯโ} {โจ splitting factor:f โฉโปยน} โฉ-โก
                  (ฮฒโ โ ฮณโ) โ[ ฯโโ ]โ                              โ-โก

            where
              lem-5a : (asArr ฮฑโ) โ ฯโ โผ (asArr (ฮฒโ โ ฮณโ)) โ ฯโ
              lem-5a = equate-ฯโ

              lem-5a' : ((asArr ฮฑโ) โ-โง๐๐ฎ๐๐ฌ๐ญ ฯโ) โผ ((asArr (ฮฒโ โ ฮณโ)) โ-โง๐๐ฎ๐๐ฌ๐ญ ฯโ)
              lem-5a' = (abstract-โ-โง๐๐ฎ๐๐ฌ๐ญ โ-โฃ lem-5a) โ-โฃ (sym-โฃ abstract-โ-โง๐๐ฎ๐๐ฌ๐ญ)

              lem-5b : ฮฑโ โ[ ฯโ ]โ โก (ฮฒโ โ ฮณโ) โ[ ฯโ ]โ
              lem-5b = let x = lem-5a'
                           y = cong-Str โจ_โฉ x
                           z = cancel-injective-incl-Hom-โง๐๐ฎ๐๐ฌ๐ญ y
                           q = โก-Strโโก z
                       in q
          -}

          postulate lem-6 : ฮโ โ[ ฮนโ ]โแถ โ[ ฯโโ ]โแถ โก ฮโ โ[ ฯแตโโ ]โแถ โ[ ฮนโ ]โแถ
          {-
          lem-6 = ฮโ โ[ ฮนโ ]โแถ โ[ ฯโโ ]โแถ  โจ functoriality-โ-โ[]โ-CtxFor {ฮ = ฮโ} {f = ฮนโ} {ฯโโ} โฉ-โก
                  ฮโ โ[ ฮนโ โ ฯโโ ]โแถ       โจ ฮโ โ[โ lem-0 โ]โ-CtxFor โฉ-โก
                  ฮโ โ[ ฯแตโโ โ ฮนโ ]โแถ      โจ sym-Path functoriality-โ-โ[]โ-CtxFor โฉ-โก
                  ฮโ โ[ ฯแตโโ ]โแถ โ[ ฮนโ ]โแถ โ-โก
          -}

          -------------
          -- lift the typing of se and te to ฮฝsโ

          postulate spโ : isTypedโHM (ฮฝsโ โฉ (_ , ฮโ โ[ ฮนโ ]โแถ) โข ฮฒโ) se
          {-
          spโ = ฮโโขฮฒแตโ
                >> isTypedโHM (ฮฝsโโ โ ฮฝsโโ โฉ (_ , ฮโ โ[ ฮนโ ]โแถ) โข ฮฒแตโ) se <<
                โช ยง-isTypedโHM.prop-3 ฮนโ โซ
                >> isTypedโHM (ฮฝsโ โฉ (_ , ฮโ โ[ ฮนโ ]โแถ) โข ฮฒโ) se <<
                โช ยง-isTypedโHM.prop-3 ฮนโ โซ
                >> isTypedโHM (ฮฝsโ โฉ (_ , ฮโ โ[ ฮนโ ]โแถ) โข ฮฒโ โ[ id โโโ ฮนโ ]โ) se <<
                >> isTypedโHM (ฮฝsโ โฉ (_ , ฮโ โ[ ฮนโ ]โแถ) โข ฮฒโ) se <<
                โช ยง-isTypedโHM.prop-2 {ฮ = _ , ฮโ โ[ ฮนโ ]โแถ} {ฯ = ฮฒโ} ฯโโ โซ
                >> isTypedโHM (ฮฝsโ โฉ (_ , ฮโ โ[ ฮนโ ]โแถ โ[ ฯโโ ]โแถ) โข ฮฒโ โ[ ฯโโ ]โ) se <<
                โช transp-isTypedโHM lem-6 refl-โก โซ
                >> isTypedโHM (ฮฝsโ โฉ (_ , ฮโ โ[ ฯแตโโ ]โแถ โ[ ฮนโ ]โแถ) โข ฮฒโ โ[ ฯโโ ]โ) se <<
                >> isTypedโHM (ฮฝsโ โฉ (_ , ฮโ โ[ ฮนโ ]โแถ) โข ฮฒโ) se <<
          -}

          postulate tpโ : isTypedโHM (ฮฝsโ โฉ (_ , ฮโ โ[ ฮนโ ]โแถ) โข (ฮฒโ โ ฮณโ)) te
          {-
          tpโ = ฮโโขฮฑแตโ

                >> isTypedโHM (ฮฝsโ โฉ (_ , ฮโ โ[ ฮนโ ]โแถ ) โข ฮฑแตโ ) te <<

                โช ยง-isTypedโHM.prop-4 ฯแตโโ ฮนโ โซ

                >> isTypedโHM (ฮฝsโ โฉ (_ , ฮโ โ[ ฯแตโโ ]โแถ โ[ ฮนโ ]โแถ ) โข ฮฑแตโ โ[ ฯแตโโ โโโ ฮนโ ]โ) te <<

                โช transp-isTypedโHM (cong _โ[ ฮนโ ]โแถ (ฮโ<ฮโ .snd)) refl-โก โซ

                >> isTypedโHM (ฮฝsโ โฉ (_ , ฮโ โ[ ฮนโ ]โแถ ) โข ฮฑโ ) te <<

                โช ยง-isTypedโHM.prop-3 ฮนโ โซ

                >> isTypedโHM (ฮฝsโ โฉ (_ , ฮโ โ[ ฮนโ ]โแถ ) โข ฮฑโ โ[ id โโโ ฮนโ ]โ) te <<
                >> isTypedโHM (ฮฝsโ โฉ (_ , ฮโ โ[ ฮนโ ]โแถ ) โข ฮฑโ) te <<

                โช ยง-isTypedโHM.prop-2 ฯโโ โซ

                >> isTypedโHM (ฮฝsโ โฉ (_ , ฮโ โ[ ฮนโ ]โแถ โ[ ฯโโ ]โแถ) โข ฮฑโ โ[ ฯโโ ]โ) te <<

                โช transp-isTypedโHM lem-6 lem-5 โซ

                >> isTypedโHM (ฮฝsโ โฉ (_ , ฮโ โ[ ฯแตโโ ]โแถ โ[ ฮนโ ]โแถ) โข (ฮฒโ โ ฮณโ) โ[ ฯโโ ]โ) te <<
                >> isTypedโHM (ฮฝsโ โฉ (_ , ฮโ โ[ ฮนโ ]โแถ) โข ฮฒโ โ ฮณโ) te <<
          -}

          -- this shows that we do have the typing instance
          ๐ : CtxTypingInstance ฮ (app te se)
          ๐ = ฮฝsโโ / ฮฝsโโ โฉ ฮโ , ฮณโ , ฮ<ฮโ , (app tpโ spโ)

          isInitial:๐ : โ(๐ : CtxTypingInstance ฮ (app te se)) -> ๐ <TI ๐
          isInitial:๐ (ฮฝsโโ / ฮฝsโโ โฉ ฮ , ฮพ , ฮ<ฮ , app {ฮฑ = ฮพโ} {ฮฒ = ฮถโ} ฮโขฮพโฮถ ฮโขฮพ) =
            record { tiSubโ = ฯแตโโ ; tiSubโ = ฯหฃโโ ; typProof = lem-32 ; subProof = lem-23 }
            where
              ฮฝsโ : โHMTypes
              ฮฝsโ = ฮฝsโโ โ ฮฝsโโ

              ฯแตแตคโ : ฮฝs โถ ฮฝsโโ
              ฯแตแตคโ = fst ฮ<ฮ

              ฮฉRโ = ฮฉโ (ฮฝsโโ / ฮฝsโโ โฉ ฮ , ((ฮพโ โ ฮถโ)) , ฮ<ฮ , ฮโขฮพโฮถ)

              ฯแตโโ : ฮฝsโโ โถ ฮฝsโโ
              ฯแตโโ = tiSubโ ฮฉRโ

              ฯหฃโโ : ฮฝsโโ โถ ฮฝsโโ โ ฮฝsโโ
              ฯหฃโโ = tiSubโ ฮฉRโ

              ฮโ<ฮ : ฮโ <ฮ ฮ
              ฮโ<ฮ = record { fst = ฯแตโโ ; snd = ctxProofTI ฮฉRโ }

              ฮฉRโ = ฮฉโ (ฮฝsโโ / ฮฝsโโ โฉ ฮ , ฮพโ , ฮโ<ฮ , ฮโขฮพ)

              ฯแตโโ : ฮฝsโโ โถ ฮฝsโโ
              ฯแตโโ = tiSubโ ฮฉRโ

              ฯหฃโโ : ฮฝsโโ โถ ฮฝsโโ โ ฮฝsโโ
              ฯหฃโโ = tiSubโ ฮฉRโ

              -------
              -- we can build a substitution from ฮฝsโ by mapping ฮณ to ฮถโ
              -- {}
              ฯโโ : st โถ ฮฝsโ
              ฯโโ = โงsubst (incl ฮถโ)

              ฯโโ : ฮฝsโ โถ ฮฝsโ
              ฯโโ = โฆ ฯแตโโ โ ฮนโ , โฆ โฆ ฯหฃโโ , ฯหฃโโ โฆ , ฯโโ โฆ โฆ -- โฆ ฯโโ , ฯโโ โฆ
              -- {}
              ------

              -- we know that under this substitution,
              -- u = ฮฑโ and v = ฮฒโ โ ฮณโ become both ฮพโฮถ

              postulate lem-11 : u โ[ ฯโโ ]โ โก ฮพโ โ ฮถโ
              {-
              lem-11 = ฮฑแตโ โ[ ฯแตโโ โโโ ฮนโ ]โ โ[ id โโโ ฮนโ ]โ โ[ ฯโโ ]โ     โจ {!!} โฉ-โก
                       ฮฑแตโ โ[ โฆ ฯแตโโ โ ฯแตโโ โ ฮนโ , ฯหฃโโ โฆ ]โ             โจ {!!} โฉ-โก
                       ฮฑแตโ โ[ โฆ ฯแตโโ โ ฮนโ , ฯหฃโโ โฆ ]โ                    โจ typProof ฮฉRโ โฉ-โก
                       ฮพโ โ ฮถโ                                         โ-โก
              -}

              -- we show how ฮฒโ and ฮณโ evaluate under ฯโโ
              postulate lem-12a : ฮฒโ โ[ ฯโโ ]โ โก ฮพโ
              {-
              lem-12a = ฮฒแตโ โ[ id โโโ ฮนโ ]โ โ[ id โโโ ฮนโ ]โ โ[ ฯโโ ]โ   โจ {!!} โฉ-โก
                        ฮฒแตโ โ[ โฆ ฯแตโโ โ ฮนโ , ฯหฃโโ โฆ ]โ                 โจ typProof ฮฉRโ โฉ-โก
                        ฮพโ                                            โ-โก
              -}

              postulate lem-12b : ฮณโ โ[ ฯโโ ]โ โก ฮถโ
              {-
              lem-12b = ฮณแตโ โ[ ฮนโ โ ฮนโ ]โ โ[ ฯโโ ]โ           โจ {!!} โฉ-โก
                        ฮณแตโ โ[ ฯโโ ]โ                         โ-โก
              -}


{-
              lem-12 : v โ[ ฯโโ ]โ โก ฮพโ โ ฮถโ
              lem-12 = ฮป i -> lem-12a i โ lem-12b i

              -- taken together
              lem-13 : (asArr u) โ ฯโโ โผ (asArr v) โ ฯโโ
              lem-13 = ((sym-โฃ abstract-โ-โง๐๐ฎ๐๐ฌ๐ญ) โ-โฃ lem-13a) โ-โฃ abstract-โ-โง๐๐ฎ๐๐ฌ๐ญ
                where
                  lem-13a : ((asArr u) โ-โง๐๐ฎ๐๐ฌ๐ญ ฯโโ) โผ ((asArr v) โ-โง๐๐ฎ๐๐ฌ๐ญ ฯโโ)
                  lem-13a = cong-Str โงsubst (cong-Str incl (โกโโก-Str (trans-Path lem-11 (sym-Path lem-12))))
-}

              -- ... thus we can use the universal property
              -- to get โจ x โฉ โถ ฮฝsโ
              ฮต : โจ x โฉ โถ ฮฝsโ
              ฮต = โฆ ฯโโ , {!!} โฆโ -- lem-13

              -- using this coequalizer derived hom, we can now build the proper
              -- 3 -> 4 morphisms

              --------------------------------------
              -- i) the "a" version
              ฯแตโโ : ฮฝsโโ โถ ฮฝsโโ
              ฯแตโโ = ฮนโ โ โจ ฯ โฉ โ ฮต โ ฯโ

              postulate lem-20 : ฯแตโโ โ ฮนโ โ โจ ฯ โฉ โผ ฮนโ โ ฯโ
              {-
              lem-20 = ฯแตโโ โ ฮนโ โ โจ ฯ โฉ              โจ lem-0 โปยน โ refl โฉ-โผ
                       ฮนโ โ ฯโโ โ โจ ฯ โฉ               โจ refl โฉ-โผ
                       ฮนโ โ (ฯโ โ โจ ฯ โฉโปยน) โ โจ ฯ โฉ    โจ assoc-l-โ โ (refl โ assoc-l-โ) โฉ-โผ
                       ฮนโ โ (ฯโ โ (โจ ฯ โฉโปยน โ โจ ฯ โฉ))  โจ refl โ (refl โ inv-l-โ (of ฯ)) โฉ-โผ
                       ฮนโ โ (ฯโ โ id)                โจ refl โ unit-r-โ โฉ-โผ
                       ฮนโ โ ฯโ                       โ
              -}

              postulate lem-21 : ฯแตโโ โ ฮนโ โ โจ ฯ โฉ โ ฮต โผ ฯแตโโ โ ฮนโ
              {-
              lem-21 = ฯแตโโ โ ฮนโ โ โจ ฯ โฉ โ ฮต      โจ lem-20 โ refl โฉ-โผ
                       ฮนโ โ ฯโ โ ฮต                โจ assoc-l-โ โฉ-โผ
                       ฮนโ โ (ฯโ โ ฮต)              โจ refl โ reduce-ฯโ โฉ-โผ
                       ฮนโ โ ฯโโ                   โจ reduce-ฮนโ โฉ-โผ
                       ฯแตโโ โ ฮนโ                  โ
              -}

              postulate lem-22 : ฯแตโโ โ ฯแตโโ โผ ฯแตโโ
              {-
              lem-22 = ฯแตโโ โ (ฮนโ โ โจ ฯ โฉ โ ฮต โ ฯโ)    โจ assoc-r-โ โฉ-โผ
                       (ฯแตโโ โ (ฮนโ โ โจ ฯ โฉ โ ฮต)) โ ฯโ  โจ assoc-r-โ โ refl โฉ-โผ
                       ((ฯแตโโ โ (ฮนโ โ โจ ฯ โฉ)) โ ฮต) โ ฯโ โจ assoc-r-โ โ refl โ refl โฉ-โผ
                       (((ฯแตโโ โ ฮนโ) โ โจ ฯ โฉ) โ ฮต) โ ฯโ โจ lem-21 โ refl โฉ-โผ
                       ฯแตโโ โ ฮนโ โ ฯโ                  โจ assoc-l-โ โฉ-โผ
                       ฯแตโโ โ (ฮนโ โ ฯโ)                โจ refl โ reduce-ฮนโ โฉ-โผ
                       ฯแตโโ โ id                       โจ unit-r-โ โฉ-โผ
                       ฯแตโโ                            โ
              -}

              postulate lem-22b : ฯแตโโ โ (ฮนโ โ โจ ฯ โฉ โ ฮต) โผ ฯแตโโ โ ฮนโ
              {-
              lem-22b = ฯแตโโ โ (ฮนโ โ โจ ฯ โฉ โ ฮต)     โจ assoc-r-โ โฉ-โผ
                        ((ฯแตโโ โ (ฮนโ โ โจ ฯ โฉ)) โ ฮต) โจ assoc-r-โ โ refl โฉ-โผ
                        (((ฯแตโโ โ ฮนโ) โ โจ ฯ โฉ) โ ฮต) โจ lem-21 โฉ-โผ
                        ฯแตโโ โ ฮนโ                  โ
              -}

              postulate lem-23 : fst ฮ<ฮโ โ ฯแตโโ โผ ฯแตแตคโ
              {-
              lem-23 = (ฯแตแตคโ โ ฯแตโโ) โ ฯแตโโ โ ฯแตโโ       โจ assoc-l-โ โฉ-โผ
                       (ฯแตแตคโ โ ฯแตโโ) โ (ฯแตโโ โ ฯแตโโ)     โจ refl โ lem-22 โฉ-โผ
                       (ฯแตแตคโ โ ฯแตโโ) โ ฯแตโโ              โจ assoc-l-โ โฉ-โผ
                       ฯแตแตคโ โ (ฯแตโโ โ ฯแตโโ)              โจ refl โ subProof ฮฉRโ โฉ-โผ
                       ฯแตแตคโ โ ฯแตโโ                       โจ subProof ฮฉRโ  โฉ-โผ
                       ฯแตแตคโ                              โ
              -}

              --------------------------------------
              -- i) the "x" version
              ฯหฃโโ : ฮฝsโโ โถ ฮฝsโ
              ฯหฃโโ = ฮนโ โ โจ ฯ โฉ โ ฮต

              postulate lem-30 : ฯแตโโ โ ฮนโ โผ ฮนโ โ โจ ฯ โฉ โ ฮต
              {-
              lem-30 = cancel-epi {{_}} {{isEpi:epiHom factor:f}} lem-30a
                where
                  lem-30a : ฯแตโโ โ (ฯแตโโ โ ฮนโ) โผ ฯแตโโ โ (ฮนโ โ โจ ฯ โฉ โ ฮต)
                  lem-30a = ฯแตโโ โ (ฯแตโโ โ ฮนโ)      โจ assoc-r-โ โฉ-โผ
                            (ฯแตโโ โ ฯแตโโ) โ ฮนโ      โจ lem-22 โ refl โฉ-โผ
                            ฯแตโโ โ ฮนโ               โจ lem-22b โปยน โฉ-โผ
                            ฯแตโโ โ (ฮนโ โ โจ ฯ โฉ โ ฮต) โ
              -}

              lem-31 : ฯโโ โ โฆ ฯแตโโ โ ฮนโ , ฯหฃโโ โฆ โผ ฯโโ
              lem-31 = ฯโโ โ โฆ ฯแตโโ โ ฮนโ , ฯหฃโโ โฆ      โจ refl โ cong-โผ {{isSetoidHom:โฆโฆ}} (lem-30 , refl) โฉ-โผ
                       ฯโโ โ โฆ ฮนโ โ โจ ฯ โฉ โ ฮต , ฯหฃโโ โฆ
                         โจ refl โ cong-โผ {{isSetoidHom:โฆโฆ}} (assoc-l-โ , assoc-l-โ) โฉ-โผ
                       ฯโโ โ โฆ ฮนโ โ (โจ ฯ โฉ โ ฮต) , (ฮนโ โ (โจ ฯ โฉ โ ฮต)) โฆ
                         โจ refl โ expand-ฮนโ,ฮนโ โปยน โฉ-โผ
                       (ฯโ โ โจ ฯ โฉโปยน) โ (โจ ฯ โฉ โ ฮต)
                         โจ assoc-[ab][cd]โผa[bc]d-โ โฉ-โผ
                       ฯโ โ (โจ ฯ โฉโปยน โ โจ ฯ โฉ) โ ฮต
                         โจ refl โ inv-l-โ (of ฯ) โ refl โฉ-โผ
                       ฯโ โ id โ ฮต
                         โจ unit-r-โ โ refl โฉ-โผ
                       ฯโ โ ฮต
                         โจ reduce-ฯโ โฉ-โผ
                       ฯโโ
                         โ

              lem-32 : ฮณโ โ[ โฆ ฯแตโโ โ ฮนโ , ฯหฃโโ โฆ ]โ โก ฮถโ
              lem-32 = ฮณโ โ[ ฯโโ ]โ โ[ โฆ ฯแตโโ โ ฮนโ , ฯหฃโโ โฆ ]โ    โจ functoriality-โ-โ[]โ {ฯ = ฮณโ} {f = ฯโโ} {โฆ ฯแตโโ โ ฮนโ , ฯหฃโโ โฆ} โฉ-โก
                       ฮณโ โ[ ฯโโ โ โฆ ฯแตโโ โ ฮนโ , ฯหฃโโ โฆ ]โ        โจ ฮณโ โ[โ lem-31 โ]โ โฉ-โก
                       ฮณโ โ[ ฯโโ ]โ                               โจ lem-12b โฉ-โก
                       ฮถโ                                         โ-โก
-}
